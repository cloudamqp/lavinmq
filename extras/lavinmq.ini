[main]
data_dir = /var/lib/lavinmq
log_level = info
;default_user_only_loopback = true
;tls_cert = /etc/lavinmq/cert.pem
;tls_key = /etc/lavinmq/key.pem

[mgmt]
bind = ::
;port = 15672
;tls_port = 15671

[amqp]
bind = ::
;port = 5672
;tls_port = 5671

[mqtt]
bind = ::
;default_vhost = /
;port = 1883
;tls_port = 8883

[clustering]
enabled = false
bind = ::
;port = 5679
;advertised_uri = tcp://hostname.local:5679
;etcd_endpoints = localhost:2379

[auth]
# Authentication chain (tries each backend in order)
;auth_backends = oauth,basic

# ===== JWT/JWKS Validation (Enterprise - Primary Method) =====
# Validates JWT tokens by verifying signature against JWKS
;jwks_uri = https://auth.example.com/.well-known/jwks.json
;jwt_issuer = https://auth.example.com
;jwt_audience = lavinmq
;oauth2_jwks_cache_ttl = 3600

# ===== Userinfo Endpoint Validation (Fallback for opaque tokens) =====
# Validates tokens by calling OAuth provider's userinfo endpoint
;oauth2_userinfo_url = https://api.github.com/user
;oauth2_username_claim = login
;oauth2_username_prefix = github:
;oauth2_default_vhost = /

# ===== Example Configurations =====

# GitHub (userinfo only - opaque tokens)
;auth_backends = oauth,basic
;oauth2_userinfo_url = https://api.github.com/user
;oauth2_username_claim = login
;oauth2_username_prefix = github:

# Auth0 (JWT with JWKS)
;auth_backends = oauth,basic
;jwks_uri = https://YOUR_DOMAIN.auth0.com/.well-known/jwks.json
;jwt_issuer = https://YOUR_DOMAIN.auth0.com/
;jwt_audience = lavinmq
;oauth2_username_claim = preferred_username

# Keycloak (JWT with JWKS)
;auth_backends = oauth,basic
;jwks_uri = https://keycloak.example.com/realms/YOUR_REALM/protocol/openid-connect/certs
;jwt_issuer = https://keycloak.example.com/realms/YOUR_REALM
;jwt_audience = lavinmq
